<!doctype html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title id="pageTitle">
      KIMU - 高雄獨立遊戲開發者聚會 - DevFest Kaohsiung X S. TW Communities Gathering 2025
    </title>

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta
      property="og:url"
      content="https://devfest2025.gdgkaohsiung.org/community/kimu/"
      id="ogUrl"
    />
    <meta
      property="og:title"
      content="KIMU - 高雄獨立遊戲開發者聚會 - DevFest 高雄場 X 南臺灣技術社群大聚 2025"
      id="ogTitle"
    />
    <meta
      property="og:description"
      content="今年 GDG Kaohsiung 和開發者 Buffet 一起在高雄舉辦軟體社群年會 - 一起探索 Google Cloud、Gemini AI、Android 開發及科技向善的最新趨勢,並且與眾多技術社群一同交流學習。"
      id="ogDescription"
    />
    <meta
      property="og:image"
      content="https://devfest2025.gdgkaohsiung.org/community/kimu/og-image.png"
      id="ogImage"
    />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:image:alt" content="KIMU - 高雄獨立遊戲開發者聚會" id="ogImageAlt" />

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta
      property="twitter:url"
      content="https://devfest2025.gdgkaohsiung.org/community/kimu/"
      id="twitterUrl"
    />
    <meta
      property="twitter:title"
      content="KIMU - 高雄獨立遊戲開發者聚會 - DevFest 高雄場 X 南臺灣技術社群大聚 2025"
      id="twitterTitle"
    />
    <meta
      property="twitter:description"
      content="今年 GDG Kaohsiung 和開發者 Buffet 一起在高雄舉辦軟體社群年會 - 一起探索 Google Cloud、Gemini AI、Android 開發及科技向善的最新趨勢,並且與眾多技術社群一同交流學習。"
      id="twitterDescription"
    />
    <meta
      property="twitter:image"
      content="https://devfest2025.gdgkaohsiung.org/community/kimu/og-image.png"
      id="twitterImage"
    />

    <!-- Additional Meta Tags -->
    <meta
      name="description"
      content="今年 GDG Kaohsiung 和開發者 Buffet 一起在高雄舉辦軟體社群年會 - 一起探索 Google Cloud、Gemini AI、Android 開發及科技向善的最新趨勢,並且與眾多技術社群一同交流學習。"
      id="metaDescription"
    />
    <meta
      name="keywords"
      content="DevFest, Kaohsiung, KIMU - 高雄獨立遊戲開發者聚會, Community, Google Developer"
      id="metaKeywords"
    />

    <!-- Canonical URL -->
    <link
      rel="canonical"
      href="https://devfest2025.gdgkaohsiung.org/community/kimu/"
      id="canonicalUrl"
    />

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="../../favicon.svg" />

    <style>
      body {
        font-family: 'Roboto', sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        margin: 0;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }
      .loading-container {
        text-align: center;
        padding: 2rem;
      }
      .spinner {
        border: 4px solid rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        border-top: 4px solid white;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
        margin: 0 auto 1rem;
      }
      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }
      h1 {
        font-size: 1.5rem;
        font-weight: 400;
        margin: 0;
      }
      p {
        margin: 0.5rem 0 0;
        opacity: 0.8;
      }
      .error-container {
        background: rgba(211, 47, 47, 0.9);
        padding: 2rem;
        border-radius: 8px;
        max-width: 500px;
      }
      .error-container h1 {
        margin-bottom: 1rem;
      }
    </style>
  </head>
  <body>
    <div class="loading-container" id="loadingContainer">
      <div class="spinner"></div>
      <h1>正在載入社群資訊...</h1>
      <p>Loading community information...</p>
    </div>

    <script>
      // 從 URL 獲取社群 ID
      function getCommunityId() {
        const pathParts = window.location.pathname.split('/').filter(Boolean);
        const communityIndex = pathParts.indexOf('community');
        if (communityIndex !== -1 && pathParts[communityIndex + 1]) {
          return pathParts[communityIndex + 1];
        }
        return null;
      }

      // 載入社群資料
      async function loadCommunityData(communityId) {
        try {
          const response = await fetch('../../data/community.json');
          if (!response.ok) {
            throw new Error('Failed to load community data');
          }

          const data = await response.json();
          const community = data.community.find((c) => c.id === communityId);

          if (!community) {
            throw new Error('Community not found');
          }

          return community;
        } catch (error) {
          console.error('Error loading community data:', error);
          throw error;
        }
      }

      // 更新頁面 meta 標籤
      function updateMetaTags(community) {
        const baseUrl = 'https://devfest2025.gdgkaohsiung.org';
        const communityId = community.id;
        const communityUrl = `${baseUrl}/community/${communityId}/`;
        const ogImageUrl = `${baseUrl}/community/${communityId}/og-image.png`;

        const nameZh = community.name.zh || community.name.en;
        const descriptionZh = community.description.zh || community.description.en;
        const categoryZh = community.category?.zh?.[0] || '參與社群';

        const title = `${nameZh} - DevFest Kaohsiung X S. TW Communities Gathering 2025`;
        const ogTitle = `${nameZh} - DevFest 2025 高雄場`;
        const description =
          '今年 GDG Kaohsiung 和開發者 Buffet 一起在高雄舉辦軟體社群年會 - 一起探索 Google Cloud、Gemini AI、Android 開發及科技向善的最新趨勢，並且與眾多技術社群一同交流學習。';
        const keywords = `DevFest, Kaohsiung, ${nameZh}, ${categoryZh}, Community, Google Developer`;

        // 更新 title
        document.title = title;
        document.getElementById('pageTitle').textContent = title;

        // 更新 Open Graph
        document.getElementById('ogUrl').setAttribute('content', communityUrl);
        document.getElementById('ogTitle').setAttribute('content', ogTitle);
        document.getElementById('ogDescription').setAttribute('content', description);
        document.getElementById('ogImage').setAttribute('content', ogImageUrl);
        document.getElementById('ogImageAlt').setAttribute('content', nameZh);

        // 更新 Twitter
        document.getElementById('twitterUrl').setAttribute('content', communityUrl);
        document.getElementById('twitterTitle').setAttribute('content', ogTitle);
        document.getElementById('twitterDescription').setAttribute('content', description);
        document.getElementById('twitterImage').setAttribute('content', ogImageUrl);

        // 更新其他 meta
        document.getElementById('metaDescription').setAttribute('content', description);
        document.getElementById('metaKeywords').setAttribute('content', keywords);
        document.getElementById('canonicalUrl').setAttribute('href', communityUrl);
      }

      // 重導向到主頁
      function redirectToMainPage(communityId) {
        const mainPageUrl = `../../index.html#community-${communityId}`;
        window.location.href = mainPageUrl;
      }

      // 顯示錯誤訊息
      function showError(message) {
        const container = document.getElementById('loadingContainer');
        container.className = 'error-container';
        container.innerHTML = `
        <h1>⚠️ 載入失敗</h1>
        <p>${message}</p>
        <p style="margin-top: 1rem;">
          <a href="../../index.html" style="color: white; text-decoration: underline;">返回主頁</a>
        </p>
      `;
      }

      // 主執行函式
      async function init() {
        const communityId = getCommunityId();

        if (!communityId) {
          showError('無效的社群 ID');
          return;
        }

        try {
          // 載入社群資料
          const community = await loadCommunityData(communityId);

          // 更新 meta 標籤
          updateMetaTags(community);

          // 等待一小段時間讓爬蟲讀取 meta 標籤
          await new Promise((resolve) => setTimeout(resolve, 100));

          // 重導向到主頁
          redirectToMainPage(communityId);
        } catch (error) {
          showError('無法載入社群資料，請確認社群 ID 是否正確。');
        }
      }

      // 執行初始化
      init();
    </script>
  </body>
</html>
